import{b as t}from"../shared/browser-polyfill.js";const n="http://localhost:8000";t.runtime.onInstalled.addListener(()=>{console.log("[Breadcrumps] Extension installed")});t.runtime.onMessage.addListener(o=>{const r=o;if(r.type==="SAVE_CONVERSATION"){const{conversation:s}=r;return fetch(`${n}/api/conversations/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s.title,source:s.source,source_url:s.source_url,messages:s.messages,scraped_at:s.scraped_at,metadata:s.metadata||{}})}).then(e=>{if(!e.ok)throw new Error(`API error: ${e.status}`);return e.json()}).then(e=>(console.log("[Breadcrumps] Saved to backend:",e.id),{success:!0,id:e.id})).catch(e=>(console.error("[Breadcrumps] Save failed:",e),{success:!1,error:e.message}))}return Promise.resolve()});
